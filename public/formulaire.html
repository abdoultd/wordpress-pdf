<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Certificat Notarié</title>
  <style>



   .certificate-container {
  width: 100%;
  max-width: 850px;
  height: auto;
  background-color: #fff;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  padding: 40px;
  box-sizing: border-box;
  line-height: 1.6;
  font-size: 16px;
  white-space: normal; /* important */
  word-break: break-word; /* coupe mots trop longs */
  overflow-wrap: break-word;
}
.certificate-text {
  text-align: justify;
}


    .certificate-content {
      position: absolute;
      bottom: 30px;
      left: 450px;
      right: 350px;
    }

    .sentence {
      font-size: 16px;
      line-height: 1.6;
      padding: 12px;
      white-space: normal;
      word-wrap: break-word;
    }

    .input-inline {
      border: none;
      outline: none;
      font-size: 16px;
      font-family: inherit;
      background: transparent;
      min-width: 10px;
      display: inline-block;
      width: auto;
      border-bottom: 1px dashed #999;
    }

    .input-measure {
      position: absolute;
      visibility: hidden;
      white-space: pre;
      font-size: 16px;
      font-family: Arial, sans-serif;
    }

    .input-no-border {
      border: none !important;
      outline: none !important;
      background-color: transparent;
    }

    /* Styles pour Profit and Loss */
    .profit-loss .subtitle {
      font-style: italic;
      color: #7f8c8d;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .profit-loss .item {
      display: flex;
      justify-content: space-between;
      margin: 8px 0;
      border-bottom: 1px solid #ddd;
      padding-bottom: 3px;
      align-items: center;
    }
    
    .profit-loss .item.total {
      font-weight: bold;
      border-top: 2px solid #000000;
      margin-top: 10px;
      padding-top: 7px;
    }
    
    .profit-loss input {
      width: 180px;
      padding: 3px 5px;
      font-size: 1em;
      text-align: right;
      border: 1px solid #ccc;
      border-radius: 3px;
    }
    
    .profit-loss input[readonly] {
      background-color: #f0f0f0;
      border-color: #000000;
      font-weight: bold;
    }
    
    /* Styles pour Balance Sheet */
    .balance-sheet .subtitle {
      font-style: italic;
      color: #7f8c8d;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .balance-sheet .section {
      margin-bottom: 40px;
    }
    
    .balance-sheet .account-item {
      display: flex;
      margin-bottom: 8px;
      padding-left: 20px;
      align-items: center;
    }
    
    .balance-sheet .account-number {
      width: 80px;
      font-weight: bold;
      color: #555;
    }
    
    .balance-sheet .account-name {
      flex: 1;
    }
    
    .balance-sheet .account-value input {
      width: 400px;
      font-weight: bold;
      text-align: right;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 3px;
    }
    
    .balance-sheet .account-value input[readonly] {
      background-color: #f0f0f0;
      border-color: #000000;
    }
    
    .balance-sheet .sub-item {
      padding-left: 40px;
      font-style: italic;
      color: #555;
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    
    .balance-sheet .total, 
    .balance-sheet .main-total {
      font-weight: bold;
      margin-top: 10px;
      border-top: 1px solid #bdc3c7;
      padding-top: 7px;
      padding-left: 20px;
      display: flex;
      justify-content: space-between;
    }
    
    .balance-sheet .main-total {
      font-size: 1.15em;
      border-top: 2px solid #000000;
      margin-top: 15px;
      padding-top: 10px;
    }
    
    /* Styles pour les boutons */
    .button-container {
      text-align: center;
      margin: 20px 0;
    }
    
    .download-container {
      text-align: center;
      margin: 40px 0;
    }
    
    button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background-color: #000000;
      color: white;
      border-radius: 4px;
      cursor: pointer;
      margin: 0 10px;
      transition: background-color 0.3s;
    }
    
    #downloadAllBtn {
      padding: 15px 30px;
      font-size: 18px;
    }
    
    button:hover {
      background-color: #000000;
    }
    
    button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .document-container {
  width: 810px; /* <- au lieu de max-width */
  margin: 0 auto 40px;
  padding: 20px;
  background: white;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

    
    h1 {
      color: #000000;
      text-align: center;
      margin-bottom: 30px;
    }
    
    h2 {
      color: hsl(0, 0%, 0%);
      margin-top: 30px;
      border-left: 4px solid #000000;
      padding-left: 10px;
    }
    
    /* Styles pour le Certificat Notarié */
   .certificate-wrapper {
      width: 90vw;
      max-width: 850px;
      position: relative;
      aspect-ratio: 850 / 1200; /* Maintient les proportions */
      /*background-image: url('TON_IMAGE.svg'); /* remplace par ton URL */
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
    }
  .container {
  position: relative;
  width: 850px;
  height: 1200px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 40px;
  box-sizing: border-box;
}

.content {
  position: absolute;
  bottom: 38%;
  left: 17%;
  width: 80%;
  font-size: 1.2vw;
  line-height: 1.5;
  text-align: justify;
}

@media (max-width: 500px) {
  .content {
    font-size: 3vw;
  }
}

.sentence {
  font-size: 16px;
  margin-bottom: 5px;
  line-height: 1.6;
  padding: 12px;
  border-radius: 5px;
  white-space: normal;
}

.input-inline {
  display: inline-block;
  max-width: 30vw;  /* limite la largeur des inputs */
  min-width: 100px;
  box-sizing: border-box;
  vertical-align: middle;
}


   .input-inline {
  border: none;
  outline: none;
  font-size: 16px;
  font-family: inherit;
  background: transparent;
  min-width: 10px;
  display: inline-block;
  width: auto;
}

.input-measure {
  position: absolute;
  visibility: hidden;
  white-space: pre;
  font-size: 16px;
  font-family: Arial, sans-serif;
}


    .button-container {
      text-align: center;
      margin: 20px 0;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background-color: #1e5e28;
      color: white;
      border-radius: 4px;
      cursor: pointer;
      margin: 0 10px;
    }

/* Supprime la bordure quand le champ est rempli */
    .input-no-border {
      border: none !important;
      outline: none !important;
      background-color: transparent;
    }


    button:hover {
      background-color: #298036;
    }

    .input-with-pound {
  position: relative;
  display: inline-block;
  width: 35%;
}

.input-with-pound input {
  width: 100%;
  padding-right: 30px;
  box-sizing: border-box;
  background-color: #f9f9f9;
  border: 1px solid #ccc;
}

.input-with-pound::after {
  content: "£";
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-weight: bold;
  color: #000000;
}
.profit-loss input,
.balance-sheet input {
  border: none !important;
  background-color: transparent !important;
  box-shadow: none !important;
  outline: none !important;
}
textarea#companyAddress {
  width: auto;
  min-width: 150px;
  max-width: 100%;
  font-family: inherit;
  font-size: 16px;
  line-height: 1.5;
  border: none;
  outline: none;
  background: transparent;
  padding: 0;
  margin: 0;
  display: inline-block;
  vertical-align: middle; 
}
.date-range {
  margin-bottom: 20px;
  font-size: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.date-range label {
  font-weight: bold;
}

.date-range select {
  padding: 4px 6px;
  font-size: 14px;
  border-radius: 3px;
  border: 1px solid #ccc;
  background-color: #fff;
}

  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>
<body>
   <div id="all-documents">
<span id="text-measurer" class="input-measure"></span>


  <div class="certificate-wrapper" id="certificate-wrapper">
<div class="container" id="certificate-container" style="background-image: url('certificat.jpeg');"></div>
 <div class="certificate-text">
    <div class="content">
       <div class="sentence">
  <input class="input-inline auto-width" id="companyName" placeholder="Company Name" />
  ("the Company") is a company incorporated under the laws of England and Wales with registered number
  <input class="input-inline auto-width" id="companyNumber" placeholder="Company Number" />
  having its registered office at<br />
  <textarea class="input-inline auto-width" id="companyAddress" placeholder="Company Address" rows="2" style="resize:none; overflow:auto;"></textarea>
</div>
        <div class="sentence">
          The above-named signatory
          is registered as a director of the Company and is authorised to represent the Company.
        </div>

        <div class="sentence">
          The above-named signatory
          appeared before me today and produced satisfactory evidence as to identity and after being duly sworn signed the above statement on oath before me.
        </div>
      </div>
    </div>
  </div>
  </div>

   <!-- Profit and Loss -->
<div class="document-container profit-loss financial-form" id="profit-loss-document">
    <div class="date-range">
  <label for="startMonth">From:</label>
  <select id="startMonth">
    <option value="01">January</option>
    <option value="02">February</option>
    <option value="03">March</option>
    <option value="04">April</option>
    <option value="05">May</option>
    <option value="06">June</option>
    <option value="07">July</option>
    <option value="08">August</option>
    <option value="09">September</option>
    <option value="10">October</option>
    <option value="11">November</option>
    <option value="12">December</option>
  </select>

<!-- Years options 2010 to 2100 -->
<select id="startYear">
  <option value="2010">2010</option>
  <option value="2011">2011</option>
  <option value="2012">2012</option>
  <option value="2013">2013</option>
  <option value="2014">2014</option>
  <option value="2015">2015</option>
  <option value="2016">2016</option>
  <option value="2017">2017</option>
  <option value="2018">2018</option>
  <option value="2019">2019</option>
  <option value="2020">2020</option>
  <option value="2021">2021</option>
  <option value="2022">2022</option>
  <option value="2023">2023</option>
  <option value="2024">2024</option>
  <option value="2025">2025</option>
  <option value="2026">2026</option>
  <option value="2027">2027</option>
  <option value="2028">2028</option>
  <option value="2029">2029</option>
  <option value="2030">2030</option>
  <option value="2031">2031</option>
  <option value="2032">2032</option>
  <option value="2033">2033</option>
  <option value="2034">2034</option>
  <option value="2035">2035</option>
  <option value="2036">2036</option>
  <option value="2037">2037</option>
  <option value="2038">2038</option>
  <option value="2039">2039</option>
  <option value="2040">2040</option>
  <option value="2041">2041</option>
  <option value="2042">2042</option>
  <option value="2043">2043</option>
  <option value="2044">2044</option>
  <option value="2045">2045</option>
  <option value="2046">2046</option>
  <option value="2047">2047</option>
  <option value="2048">2048</option>
  <option value="2049">2049</option>
  <option value="2050">2050</option>
  <option value="2051">2051</option>
  <option value="2052">2052</option>
  <option value="2053">2053</option>
  <option value="2054">2054</option>
  <option value="2055">2055</option>
  <option value="2056">2056</option>
  <option value="2057">2057</option>
  <option value="2058">2058</option>
  <option value="2059">2059</option>
  <option value="2060">2060</option>
  <option value="2061">2061</option>
  <option value="2062">2062</option>
  <option value="2063">2063</option>
  <option value="2064">2064</option>
  <option value="2065">2065</option>
  <option value="2066">2066</option>
  <option value="2067">2067</option>
  <option value="2068">2068</option>
  <option value="2069">2069</option>
  <option value="2070">2070</option>
  <option value="2071">2071</option>
  <option value="2072">2072</option>
  <option value="2073">2073</option>
  <option value="2074">2074</option>
  <option value="2075">2075</option>
  <option value="2076">2076</option>
  <option value="2077">2077</option>
  <option value="2078">2078</option>
  <option value="2079">2079</option>
  <option value="2080">2080</option>
  <option value="2081">2081</option>
  <option value="2082">2082</option>
  <option value="2083">2083</option>
  <option value="2084">2084</option>
  <option value="2085">2085</option>
  <option value="2086">2086</option>
  <option value="2087">2087</option>
  <option value="2088">2088</option>
  <option value="2089">2089</option>
  <option value="2090">2090</option>
  <option value="2091">2091</option>
  <option value="2092">2092</option>
  <option value="2093">2093</option>
  <option value="2094">2094</option>
  <option value="2095">2095</option>
  <option value="2096">2096</option>
  <option value="2097">2097</option>
  <option value="2098">2098</option>
  <option value="2099">2099</option>
  <option value="2100">2100</option>
</select>


  <label for="endMonth">to</label>
  <select id="endMonth">
    <option value="01">January</option>
    <option value="02">February</option>
    <option value="03">March</option>
    <option value="04">April</option>
    <option value="05" selected>May</option>
    <option value="06">June</option>
    <option value="07">July</option>
    <option value="08">August</option>
    <option value="09">September</option>
    <option value="10">October</option>
    <option value="11">November</option>
    <option value="12">December</option>
  </select>

 <!-- Years options 2010 to 2100 -->
<select id="startYear">
  <option value="2010">2010</option>
  <option value="2011">2011</option>
  <option value="2012">2012</option>
  <option value="2013">2013</option>
  <option value="2014">2014</option>
  <option value="2015">2015</option>
  <option value="2016">2016</option>
  <option value="2017">2017</option>
  <option value="2018">2018</option>
  <option value="2019">2019</option>
  <option value="2020">2020</option>
  <option value="2021">2021</option>
  <option value="2022">2022</option>
  <option value="2023">2023</option>
  <option value="2024">2024</option>
  <option value="2025">2025</option>
  <option value="2026">2026</option>
  <option value="2027">2027</option>
  <option value="2028">2028</option>
  <option value="2029">2029</option>
  <option value="2030">2030</option>
  <option value="2031">2031</option>
  <option value="2032">2032</option>
  <option value="2033">2033</option>
  <option value="2034">2034</option>
  <option value="2035">2035</option>
  <option value="2036">2036</option>
  <option value="2037">2037</option>
  <option value="2038">2038</option>
  <option value="2039">2039</option>
  <option value="2040">2040</option>
  <option value="2041">2041</option>
  <option value="2042">2042</option>
  <option value="2043">2043</option>
  <option value="2044">2044</option>
  <option value="2045">2045</option>
  <option value="2046">2046</option>
  <option value="2047">2047</option>
  <option value="2048">2048</option>
  <option value="2049">2049</option>
  <option value="2050">2050</option>
  <option value="2051">2051</option>
  <option value="2052">2052</option>
  <option value="2053">2053</option>
  <option value="2054">2054</option>
  <option value="2055">2055</option>
  <option value="2056">2056</option>
  <option value="2057">2057</option>
  <option value="2058">2058</option>
  <option value="2059">2059</option>
  <option value="2060">2060</option>
  <option value="2061">2061</option>
  <option value="2062">2062</option>
  <option value="2063">2063</option>
  <option value="2064">2064</option>
  <option value="2065">2065</option>
  <option value="2066">2066</option>
  <option value="2067">2067</option>
  <option value="2068">2068</option>
  <option value="2069">2069</option>
  <option value="2070">2070</option>
  <option value="2071">2071</option>
  <option value="2072">2072</option>
  <option value="2073">2073</option>
  <option value="2074">2074</option>
  <option value="2075">2075</option>
  <option value="2076">2076</option>
  <option value="2077">2077</option>
  <option value="2078">2078</option>
  <option value="2079">2079</option>
  <option value="2080">2080</option>
  <option value="2081">2081</option>
  <option value="2082">2082</option>
  <option value="2083">2083</option>
  <option value="2084">2084</option>
  <option value="2085">2085</option>
  <option value="2086">2086</option>
  <option value="2087">2087</option>
  <option value="2088">2088</option>
  <option value="2089">2089</option>
  <option value="2090">2090</option>
  <option value="2091">2091</option>
  <option value="2092">2092</option>
  <option value="2093">2093</option>
  <option value="2094">2094</option>
  <option value="2095">2095</option>
  <option value="2096">2096</option>
  <option value="2097">2097</option>
  <option value="2098">2098</option>
  <option value="2099">2099</option>
  <option value="2100">2100</option>
</select>
</div>
  <h1>Profit and Loss</h1>

  <p><em>Caution: Enter multiple amounts separated by a semicolon <code>;</code>. Example : <code>180.143,02; 200,50; 0,97</code></em></p>
  <h2>INCOME</h2>
  <div class="item">
    <div>Bank Interest Received</div>
    <div class="input-with-pound">
      <input type="text" id="bankInterest" placeholder="ex: 0,97 ou 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>Sales</div>
    <div class="input-with-pound">
      <input type="text" id="sales" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item total">
    <div>Total Income</div>
    <div class="input-with-pound">
      <input type="text" id="totalIncome" readonly />
    </div>
  </div>

  <h2>COST OF SALES</h2>
  <div class="item">
    <div>Purchases</div>
    <div class="input-with-pound">
      <input type="text" id="purchases" placeholder="ex: 0,97 ou 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item total">
    <div>Total Cost of Sales</div>
    <div class="input-with-pound">
      <input type="text" id="totalCostOfSales" readonly />
    </div>
  </div>

  <h2>GROSS PROFIT</h2>
  <div class="item total">
    <div>Gross Profit</div>
    <div class="input-with-pound">
      <input type="text" id="grossProfit" readonly />
    </div>
  </div>

  <h2>EXPENSES</h2>
  <div class="item">
    <div>Travelling</div>
    <div class="input-with-pound">
      <input type="text" id="travelling" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>Postage and Carriage</div>
    <div class="input-with-pound">
      <input type="text" id="postage" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>Computers & Software</div>
    <div class="input-with-pound">
      <input type="text" id="computers" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>Accountancy Fees</div>
    <div class="input-with-pound">
      <input type="text" id="accountancy" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>Currency Charges</div>
    <div class="input-with-pound">
      <input type="text" id="currency" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>Bank Charges</div>
    <div class="input-with-pound">
      <input type="text" id="bankCharges" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>Rent</div>
    <div class="input-with-pound">
      <input type="text" id="rent" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item total">
    <div>Total Expenses</div>
    <div class="input-with-pound">
      <input type="text" id="totalExpenses" readonly />
    </div>
  </div>

  <h2>NET OPERATING INCOME</h2>
  <div class="item total">
    <div>Net Operating Income</div>
    <div class="input-with-pound">
      <input type="text" id="netOperatingIncome" readonly />
    </div>
  </div>

  <h2>NET INCOME</h2>
  <div class="item total">
    <div>Net Income</div>
    <div class="input-with-pound">
      <input type="text" id="netIncome" readonly />
    </div>
  </div>
</div>
   <!-- Balance Sheet -->
<div class="document-container balance-sheet financial-form" id="balance-sheet-document">
   <div> 
         <div class="date-range">
  <label for="startMonth">From:</label>
  <select id="startMonth">
    <option value="01">January</option>
    <option value="02">February</option>
    <option value="03">March</option>
    <option value="04">April</option>
    <option value="05">May</option>
    <option value="06">June</option>
    <option value="07">July</option>
    <option value="08">August</option>
    <option value="09">September</option>
    <option value="10">October</option>
    <option value="11">November</option>
    <option value="12">December</option>
  </select>

<!-- Years options 2010 to 2100 -->
<select id="startYear">
  <option value="2010">2010</option>
  <option value="2011">2011</option>
  <option value="2012">2012</option>
  <option value="2013">2013</option>
  <option value="2014">2014</option>
  <option value="2015">2015</option>
  <option value="2016">2016</option>
  <option value="2017">2017</option>
  <option value="2018">2018</option>
  <option value="2019">2019</option>
  <option value="2020">2020</option>
  <option value="2021">2021</option>
  <option value="2022">2022</option>
  <option value="2023">2023</option>
  <option value="2024">2024</option>
  <option value="2025">2025</option>
  <option value="2026">2026</option>
  <option value="2027">2027</option>
  <option value="2028">2028</option>
  <option value="2029">2029</option>
  <option value="2030">2030</option>
  <option value="2031">2031</option>
  <option value="2032">2032</option>
  <option value="2033">2033</option>
  <option value="2034">2034</option>
  <option value="2035">2035</option>
  <option value="2036">2036</option>
  <option value="2037">2037</option>
  <option value="2038">2038</option>
  <option value="2039">2039</option>
  <option value="2040">2040</option>
  <option value="2041">2041</option>
  <option value="2042">2042</option>
  <option value="2043">2043</option>
  <option value="2044">2044</option>
  <option value="2045">2045</option>
  <option value="2046">2046</option>
  <option value="2047">2047</option>
  <option value="2048">2048</option>
  <option value="2049">2049</option>
  <option value="2050">2050</option>
  <option value="2051">2051</option>
  <option value="2052">2052</option>
  <option value="2053">2053</option>
  <option value="2054">2054</option>
  <option value="2055">2055</option>
  <option value="2056">2056</option>
  <option value="2057">2057</option>
  <option value="2058">2058</option>
  <option value="2059">2059</option>
  <option value="2060">2060</option>
  <option value="2061">2061</option>
  <option value="2062">2062</option>
  <option value="2063">2063</option>
  <option value="2064">2064</option>
  <option value="2065">2065</option>
  <option value="2066">2066</option>
  <option value="2067">2067</option>
  <option value="2068">2068</option>
  <option value="2069">2069</option>
  <option value="2070">2070</option>
  <option value="2071">2071</option>
  <option value="2072">2072</option>
  <option value="2073">2073</option>
  <option value="2074">2074</option>
  <option value="2075">2075</option>
  <option value="2076">2076</option>
  <option value="2077">2077</option>
  <option value="2078">2078</option>
  <option value="2079">2079</option>
  <option value="2080">2080</option>
  <option value="2081">2081</option>
  <option value="2082">2082</option>
  <option value="2083">2083</option>
  <option value="2084">2084</option>
  <option value="2085">2085</option>
  <option value="2086">2086</option>
  <option value="2087">2087</option>
  <option value="2088">2088</option>
  <option value="2089">2089</option>
  <option value="2090">2090</option>
  <option value="2091">2091</option>
  <option value="2092">2092</option>
  <option value="2093">2093</option>
  <option value="2094">2094</option>
  <option value="2095">2095</option>
  <option value="2096">2096</option>
  <option value="2097">2097</option>
  <option value="2098">2098</option>
  <option value="2099">2099</option>
  <option value="2100">2100</option>
</select>


  <label for="endMonth">to</label>
  <select id="endMonth">
    <option value="01">January</option>
    <option value="02">February</option>
    <option value="03">March</option>
    <option value="04">April</option>
    <option value="05" selected>May</option>
    <option value="06">June</option>
    <option value="07">July</option>
    <option value="08">August</option>
    <option value="09">September</option>
    <option value="10">October</option>
    <option value="11">November</option>
    <option value="12">December</option>
  </select>

 <!-- Years options 2010 to 2100 -->
<select id="startYear">
  <option value="2010">2010</option>
  <option value="2011">2011</option>
  <option value="2012">2012</option>
  <option value="2013">2013</option>
  <option value="2014">2014</option>
  <option value="2015">2015</option>
  <option value="2016">2016</option>
  <option value="2017">2017</option>
  <option value="2018">2018</option>
  <option value="2019">2019</option>
  <option value="2020">2020</option>
  <option value="2021">2021</option>
  <option value="2022">2022</option>
  <option value="2023">2023</option>
  <option value="2024">2024</option>
  <option value="2025">2025</option>
  <option value="2026">2026</option>
  <option value="2027">2027</option>
  <option value="2028">2028</option>
  <option value="2029">2029</option>
  <option value="2030">2030</option>
  <option value="2031">2031</option>
  <option value="2032">2032</option>
  <option value="2033">2033</option>
  <option value="2034">2034</option>
  <option value="2035">2035</option>
  <option value="2036">2036</option>
  <option value="2037">2037</option>
  <option value="2038">2038</option>
  <option value="2039">2039</option>
  <option value="2040">2040</option>
  <option value="2041">2041</option>
  <option value="2042">2042</option>
  <option value="2043">2043</option>
  <option value="2044">2044</option>
  <option value="2045">2045</option>
  <option value="2046">2046</option>
  <option value="2047">2047</option>
  <option value="2048">2048</option>
  <option value="2049">2049</option>
  <option value="2050">2050</option>
  <option value="2051">2051</option>
  <option value="2052">2052</option>
  <option value="2053">2053</option>
  <option value="2054">2054</option>
  <option value="2055">2055</option>
  <option value="2056">2056</option>
  <option value="2057">2057</option>
  <option value="2058">2058</option>
  <option value="2059">2059</option>
  <option value="2060">2060</option>
  <option value="2061">2061</option>
  <option value="2062">2062</option>
  <option value="2063">2063</option>
  <option value="2064">2064</option>
  <option value="2065">2065</option>
  <option value="2066">2066</option>
  <option value="2067">2067</option>
  <option value="2068">2068</option>
  <option value="2069">2069</option>
  <option value="2070">2070</option>
  <option value="2071">2071</option>
  <option value="2072">2072</option>
  <option value="2073">2073</option>
  <option value="2074">2074</option>
  <option value="2075">2075</option>
  <option value="2076">2076</option>
  <option value="2077">2077</option>
  <option value="2078">2078</option>
  <option value="2079">2079</option>
  <option value="2080">2080</option>
  <option value="2081">2081</option>
  <option value="2082">2082</option>
  <option value="2083">2083</option>
  <option value="2084">2084</option>
  <option value="2085">2085</option>
  <option value="2086">2086</option>
  <option value="2087">2087</option>
  <option value="2088">2088</option>
  <option value="2089">2089</option>
  <option value="2090">2090</option>
  <option value="2091">2091</option>
  <option value="2092">2092</option>
  <option value="2093">2093</option>
  <option value="2094">2094</option>
  <option value="2095">2095</option>
  <option value="2096">2096</option>
  <option value="2097">2097</option>
  <option value="2098">2098</option>
  <option value="2099">2099</option>
  <option value="2100">2100</option>
 </select>
 </div>
  <h1>Balance Sheet</h1>
  <!-- ACTIFS COURANTS -->
  <div class="section">
    <h2>ACTIFS COURANTS (Current Assets)</h2>

    <div class="account-item">
      <div class="account-number">1154</div>
      <div class="account-name">Inter Company Account</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="interCompany" value="0" /></div>
    </div>

    <div class="account-item">
      <div class="account-number">1200</div>
      <div class="account-name">Santander Account</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="santander" value="0" /></div>
    </div>

    <div class="account-item">
      <div class="account-number">1501</div>
      <div class="account-name">Stripe Account</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="stripe" value="0" /></div>
    </div>

    <div class="account-item">
      <div class="account-number">1800</div>
      <div class="account-name">Paypal Account</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="paypal" value="0" /></div>
    </div>

    <div class="account-item">
      <div class="account-number">1904</div>
      <div class="account-name">Elavon UK</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="elavon" value="0" /></div>
    </div>

    <div class="total">
      <div>Total Cash at Bank and in Hand</div>
      <div class="input-with-pound"><input type="text" id="totalCash" style="font-weight: bold;" readonly /></div>
    </div>

    <div class="account-item">
      <div class="account-number">1100</div>
      <div class="account-name">Debtors Control Account</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="debtorsControlAccount" value="0" /></div>
    </div>

    <div class="total">
      <div>Total Debtors</div>
      <div class="input-with-pound"><input type="text" id="totalDebtors" style="font-weight: bold;"  readonly /></div>
    </div>

    <div class="main-total">
      <div>Net Current Assets</div>
      <div class="input-with-pound"><input type="text" id="netCurrentAssets" style="font-weight: bold;" readonly /></div>
    </div>
  </div>

  <!-- PASSIFS COURANTS -->
  <div class="section">
    <h2>PASSIFS COURANTS (Current Liabilities)</h2>

    <div class="account-item">
      <div class="account-number">2100</div>
      <div class="account-name">Trade Creditors Account</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="tradeCreditors" value="0" /></div>
    </div>

    <div class="sub-item">
      <div class="account-name">Corporate Tax Payable</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="corporateTax" value="0" /></div>
    </div>

    <div class="sub-item">
      <div class="account-name">VAT Group</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="vatGroup" value="0" /></div>
    </div>

    <div class="sub-item">
      <div class="account-name">VAT Services</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="vatServices" value="0" /></div>
    </div>

    <div class="total">
      <div>Total Current Liabilities</div>
      <div class="input-with-pound"><input type="text" id="totalCurrentLiabilities" style="font-weight: bold;" readonly /></div>
    </div>

    <div class="total">
      <div>Total Creditors</div>
      <div class="input-with-pound"><input type="text" id="totalCreditors" style="font-weight: bold;" readonly /></div>
    </div>

    <div class="main-total">
      <div>Net Current Assets (Liabilities)</div>
      <div class="input-with-pound"><input type="text" id="netCurrentAssetsLiabilities" style="font-weight: bold;" readonly /></div>
    </div>
  </div>

  <!-- PASSIFS À LONG TERME -->
  <div class="section">
    <h2>PASSIFS À LONG TERME (Long-Term Creditors)</h2>

    <div class="account-item">
      <div class="account-number">2000</div>
      <div class="account-name">Loans</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="loans" value="0" /></div>
    </div>

    <div class="account-item">
      <div class="account-number">2019</div>
      <div class="account-name">Direct Loan</div>
      <div class="input-with-pound"><input type="text" step="0.01" min="0" id="directLoan" value="0" /></div>
    </div>

    <div class="total">
      <div>Total Creditors (Loans + Direct Loan)</div>
      <div class="input-with-pound"><input type="text" id="totalCreditorsLoans" style="font-weight: bold;" readonly /></div>
    </div>

    <div class="main-total">
      <div>Total Net Assets (Liabilities)</div>
      <div class="input-with-pound"><input type="text" id="totalNetAssets" style="font-weight: bold;"  readonly /></div>
    </div>
  </div>

  <!-- CAPITAUX PROPRES -->
  <div class="section">
    <h2>CAPITAL ET RÉSERVES (Capital and Reserves)</h2>

    <div class="account-item">
      <div class="account-number">3000</div>
      <div class="account-name">Ordinary Shares</div>
      <div class="input-with-pound"><input type="text" step="0.01" id="ordinaryShares" value="0" /></div>
    </div>

    <div class="account-item">
      <div class="account-name">Retained Earnings</div>
      <div class="input-with-pound"><input type="text" step="0.01" id="retainedEarnings" value="0" /></div>
    </div>

    <div class="account-item">
      <div class="account-name">Profit for the Year</div>
      <div class="input-with-pound"><input type="text" step="0.01" id="profitForYear" value="0" /></div>
    </div>

    <div class="total">
      <div>Total Capital and Reserves</div>
      <div class="input-with-pound"><input type="text" id="totalCapitalReserves" style="font-weight: bold;"  readonly /></div>
    </div>
  </div>
</div>

<div class="button-container">
  <button id="downloadAllBtn">Download all documents in PDF</button>
</div>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  
<script>
  document.querySelectorAll('input[type="text"], input[type="text"]').forEach(input => {
    if (!input.parentElement.classList.contains('input-with-pound')) {
      const wrapper = document.createElement('div');
      wrapper.classList.add('input-with-pound');
      input.parentElement.replaceChild(wrapper, input);
      wrapper.appendChild(input);
    }
  });

  const inputs = document.querySelectorAll('.auto-width');
  inputs.forEach(input => {
    input.style.width = '10px';
    input.addEventListener('input', () => {
      input.style.width = '10px';
      input.style.width = (input.value.length + 1) + 'ch';
    });
  });

  const { jsPDF } = window.jspdf;

  const certInputs = document.querySelectorAll('.input-inline');
  const measurer = document.getElementById('text-measurer');

  certInputs.forEach(input => {
    const adjustWidth = () => {
      measurer.style.font = getComputedStyle(input).font;
      measurer.textContent = input.value || input.placeholder || "";
      input.style.width = (measurer.scrollWidth + 10) + "px";
    };

    input.addEventListener('input', adjustWidth);
    adjustWidth();

    input.addEventListener('input', () => {
      if (input.value.trim() !== '') {
        input.classList.add('input-no-border');
      } else {
        input.classList.remove('input-no-border');
      }
    });
  });

  function parseFrenchNumber(str) {
    if (!str) return NaN;
    str = str.trim().replace(/\s/g, '').replace(/\./g, '').replace(/,/g, '.');
    return parseFloat(str);
  }

  function sumFrenchNumbersFromInput(id) {
    const value = document.getElementById(id).value;
    if (!value) return 0;
    const parts = value.split(';').map(s => s.trim()).filter(s => s !== '');
    const numbers = parts.map(parseFrenchNumber).filter(n => !isNaN(n));
    return numbers.reduce((a, b) => a + b, 0);
  }

  function formatFrenchNumber(num) {
    return num.toLocaleString('fr-FR', { maximumFractionDigits: 2 });
  }

  function calculateProfitLoss() {
    const bankInterestSum = sumFrenchNumbersFromInput('bankInterest');
    const salesSum = sumFrenchNumbersFromInput('sales');
    const totalIncome = bankInterestSum + salesSum;
    document.getElementById('totalIncome').value = formatFrenchNumber(totalIncome);

    const purchasesSum = sumFrenchNumbersFromInput('purchases');
    document.getElementById('totalCostOfSales').value = formatFrenchNumber(purchasesSum);

    const grossProfit = totalIncome - purchasesSum;
    document.getElementById('grossProfit').value = formatFrenchNumber(grossProfit);

    const expenseFields = ['travelling', 'postage', 'computers', 'accountancy', 'currency', 'bankCharges', 'rent'];
    const totalExpenses = expenseFields.map(sumFrenchNumbersFromInput).reduce((a, b) => a + b, 0);
    document.getElementById('totalExpenses').value = formatFrenchNumber(totalExpenses);

    const netOperatingIncome = grossProfit - totalExpenses;
    document.getElementById('netOperatingIncome').value = formatFrenchNumber(netOperatingIncome);
    document.getElementById('netIncome').value = formatFrenchNumber(netOperatingIncome);
  }

  const profitLossInputIds = [
    'bankInterest', 'sales', 'purchases',
    'travelling', 'postage', 'computers',
    'accountancy', 'currency', 'bankCharges', 'rent'
  ];

  profitLossInputIds.forEach(id => {
    document.getElementById(id).addEventListener('input', calculateProfitLoss);
  });

  function getVal(id) {
    const val = parseFloat(document.getElementById(id).value);
    return isNaN(val) ? 0 : val;
  }

  function calculateBalanceSheet() {
    const totalCash = getVal('interCompany') + getVal('santander') + getVal('stripe') + getVal('paypal') + getVal('elavon');
    document.getElementById('totalCash').value = totalCash.toFixed(2);

    const totalDebtors = getVal('debtorsControlAccount');
    document.getElementById('totalDebtors').value = totalDebtors.toFixed(2);

    const netCurrentAssets = totalCash + totalDebtors;
    document.getElementById('netCurrentAssets').value = netCurrentAssets.toFixed(2);

    const totalCurrentLiabilities = getVal('corporateTax') + getVal('vatGroup') + getVal('vatServices');
    document.getElementById('totalCurrentLiabilities').value = totalCurrentLiabilities.toFixed(2);

    const tradeCreditors = getVal('tradeCreditors');
    const totalCreditors = tradeCreditors + totalCurrentLiabilities;
    document.getElementById('totalCreditors').value = totalCreditors.toFixed(2);

    const netCurrentAssetsLiabilities = netCurrentAssets - totalCreditors;
    document.getElementById('netCurrentAssetsLiabilities').value = netCurrentAssetsLiabilities.toFixed(2);

    const totalCreditorsLoans = getVal('loans') + getVal('directLoan');
    document.getElementById('totalCreditorsLoans').value = totalCreditorsLoans.toFixed(2);

    const totalNetAssets = netCurrentAssetsLiabilities - totalCreditorsLoans;
    document.getElementById('totalNetAssets').value = totalNetAssets.toFixed(2);

    const totalCapitalReserves = getVal('ordinaryShares') + getVal('retainedEarnings') + getVal('profitForYear');
    document.getElementById('totalCapitalReserves').value = totalCapitalReserves.toFixed(2);
  }

  const balanceSheetFields = [
    'interCompany', 'santander', 'stripe', 'paypal', 'elavon',
    'debtorsControlAccount', 'tradeCreditors', 'corporateTax',
    'vatGroup', 'vatServices', 'loans', 'directLoan',
    'ordinaryShares', 'retainedEarnings', 'profitForYear'
  ];

  balanceSheetFields.forEach(id => {
    document.getElementById(id).addEventListener('input', calculateBalanceSheet);
  });

  calculateProfitLoss();
  calculateBalanceSheet();

  document.getElementById('downloadAllBtn').addEventListener('click', async function () {
    this.textContent = "Génération en cours...";
    this.disabled = true;

    try {
      const doc = new jsPDF('p', 'mm', 'a4');
      const pageWidth = doc.internal.pageSize.getWidth();
      const pageHeight = doc.internal.pageSize.getHeight();
      doc.deletePage(1);

      const addHtmlContent = async (elementId, title = '') => {
        const element = document.getElementById(elementId);
        if (!element) return;

        const originalBg = element.style.backgroundColor;
        element.style.backgroundColor = 'white';

        const canvas = await html2canvas(element, {
          scale: 1.2,
          logging: false,
          useCORS: true,
          allowTaint: false,
          backgroundColor: '#FFFFFF'
        });

        element.style.backgroundColor = originalBg;

        doc.addPage('a4');
        doc.setFillColor(255, 255, 255);
        doc.rect(0, 0, pageWidth, pageHeight, 'F');

        if (title) {
          doc.setFontSize(16);
          doc.setTextColor(0, 0, 0);
          doc.text(title, 20, 20);
        }

        const imgData = canvas.toDataURL('image/jpeg', 0.8);
        const imgWidth = pageWidth - 40;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;

        doc.addImage(imgData, 'JPEG', 20, title ? 30 : 20, imgWidth, imgHeight);
      };

      await addHtmlContent('certificate-wrapper');
      await addHtmlContent('profit-loss-document');
      await addHtmlContent('balance-sheet-document');

      doc.save('Documents_Complets.pdf');

    } catch (error) {
      console.error(error);
      alert("Erreur lors de la génération du PDF: " + error.message);
    } finally {
      this.textContent = "Télécharger tous les documents en PDF";
      this.disabled = false;
    }
  });
</script>

</body>
</html>