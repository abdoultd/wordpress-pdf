<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Certificat Notarié</title>
  <style>



   .certificate-wrapper {
  width: 100%;
  max-width: 850px;
  margin: 0 auto;
  position: relative;
}

.container {
  width: 100%;
  height: auto;
  min-height: 1200px;
  background-size: cover;
  background-position: center;
  padding: 40px;
  box-sizing: border-box;
}

.certificate-content {
  position: relative;
  width: 80%;
  margin: 0 auto;
  font-size: 16px;
  line-height: 1.6;
}

.sentence {
  margin-bottom: 20px;
  text-align: justify;
}

.input-inline {
  border: none;
  border-bottom: 1px dashed #999;
  background: transparent;
  font-size: 16px;
  min-width: 50px;
  display: inline-block;
}

textarea.input-inline {
  width: 100%;
  border: none;
  border-bottom: 1px dashed #999;
  overflow: hidden;
  resize: none;
}

    /* Styles pour Profit and Loss */
    .profit-loss .subtitle {
      font-style: italic;
      color: #7f8c8d;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .profit-loss .item {
      display: flex;
      justify-content: space-between;
      margin: 8px 0;
      border-bottom: 1px solid #ddd;
      padding-bottom: 3px;
      align-items: center;
    }
    
    .profit-loss .item.total {
      font-weight: bold;
      border-top: 2px solid #000000;
      margin-top: 10px;
      padding-top: 7px;
    }
    
    .profit-loss input {
      width: 180px;
      padding: 3px 5px;
      font-size: 1em;
      text-align: right;
      border: 1px solid #ccc;
      border-radius: 3px;
    }
    
    .profit-loss input[readonly] {
      background-color: #f0f0f0;
      border-color: #000000;
      font-weight: bold;
    }
    
   /* Remplacer TOUS les styles de Balance Sheet par ceux-ci */
.balance-sheet {
  font-family: Arial, sans-serif;
  color: #333;
}

.balance-sheet .section {
  margin-bottom: 10px;
}

.balance-sheet .account-item {
  display: flex;
  justify-content: space-between;
  margin: 2px 0;
  border-bottom: 1px solid #ddd;
  padding-bottom: 2px;
  align-items: center;
}

.balance-sheet .account-number {
  width: 30px;
  color: #101010;
  margin-right: 14px;
}

.balance-sheet .account-name {
  flex-grow: 1;
}

.balance-sheet input {
  width: 140px;
  padding:2px 4px;
  font-size: 1em;
  text-align: right;
  border: 1px solid #ccc;
  border-radius: 3px; 
  background-color: transparent;
}

.balance-sheet input[readonly] {
  background-color: #f0f0f0;
  border-color: #000;
  font-weight: bold;
}

.balance-sheet .sub-item {
  padding-left: 50px; /* 80px pour le numéro + 15px de marge */
  font-style: italic;
  color: #555;
  display: flex;
  justify-content: space-between;
  margin: 2px 0;
  border-bottom: 1px solid #ddd;
  padding-bottom: 2px;
}

/* Styles pour les totaux - Version corrigée */
.balance-sheet .total,
.balance-sheet .main-total {
  display: flex;
  justify-content: space-between;
  font-weight: bold;
  border-top: 2px solid #000;
  margin-top: 8px;
  padding-top: 5px;
  padding-left: 0; /* Suppression du padding gauche */
  align-items: center;
}

/* Ajustement spécifique pour l'input des totaux */
.balance-sheet .total .input-with-pound,
.balance-sheet .main-total .input-with-pound {
  width: 180px; /* Largeur identique aux autres inputs */
}

.balance-sheet .total > div:first-child,
.balance-sheet .main-total > div:first-child {
  flex-grow: 1; /* Permet au texte de prendre l'espace disponible */
}
    
    /* Styles pour les boutons */
    .button-container {
      text-align: center;
      margin: 20px 0;
    }
    
    .download-container {
      text-align: center;
      margin: 40px 0;
    }
    
    button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background-color: #000000;
      color: white;
      border-radius: 4px;
      cursor: pointer;
      margin: 0 10px;
      transition: background-color 0.3s;
    }
    
    #downloadAllBtn {
      padding: 15px 30px;
      font-size: 18px;
    }
    
    button:hover {
      background-color: #000000;
    }
    
    button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .document-container {
  width: 810px; /* <- au lieu de max-width */
  margin: 0 auto 40px;
  padding: 8px;
  background: white;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

    
    h1 {
      color: #000000;
      text-align: center;
      margin-bottom: 30px;
    }
    
    h2 {
      color: hsl(0, 0%, 0%);
      margin-top: 13px;
      border-left: 4px solid #000000;
      padding-left: 10px;
      font-size: 14px;
    }
    
    /* Styles pour le Certificat Notarié */
   .certificate-wrapper {
      width: 90vw;
      max-width: 850px;
      position: relative;
      aspect-ratio: 850 / 1200; /* Maintient les proportions */
      /*background-image: url('TON_IMAGE.svg'); /* remplace par ton URL */
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
    }
  .container {
  position: relative;
  width: 850px;
  height: 1200px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 40px;
  box-sizing: border-box;
}

.content {
  position: absolute;
  bottom: 38%;
  left: 17%;
  width: 80%;
  font-size: 1.2vw;
  line-height: 1.3;
  text-align: justify;
}

@media (max-width: 500px) {
  .content {
    font-size: 3vw;
  }
}

.sentence {
  font-size: 16px;
  margin-bottom: 5px;
  line-height: 1.3;
  padding: 12px;
  border-radius: 5px;
  white-space: normal;
}

.input-inline {
  display: inline-block;
  max-width: 30vw;  /* limite la largeur des inputs */
  min-width: 100px;
  box-sizing: border-box;
  vertical-align: middle;
}


   .input-inline {
  border: none;
  outline: none;
  font-size: 16px;
  font-family: inherit;
  background: transparent;
  min-width: 10px;
  display: inline-block;
  width: auto;
}

.input-measure {
  position: absolute;
  visibility: hidden;
  white-space: pre;
  font-size: 16px;
  font-family: Arial, sans-serif;
}


    .button-container {
      text-align: center;
      margin: 20px 0;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background-color: #1e5e28;
      color: white;
      border-radius: 4px;
      cursor: pointer;
      margin: 0 10px;
    }

/* Supprime la bordure quand le champ est rempli */
    .input-no-border {
      border: none !important;
      outline: none !important;
      background-color: transparent;
    }


    button:hover {
      background-color: #298036;
    }

    .input-with-pound {
  position: relative;
  display: inline-block;
  width: 35%;
}

.input-with-pound input {
  width: 100%;
  padding-right: 30px;
  box-sizing: border-box;
  background-color: #f9f9f9;
  border: 1px solid #ccc;
}

.input-with-pound::after {
  content: "£";
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-weight: bold;
  color: #000000;
}
.profit-loss input,
.balance-sheet input {
  border: none !important;
  background-color: transparent !important;
  box-shadow: none !important;
  outline: none !important;
}
textarea#companyAddress {
  width: 100%;
  min-width: 150px;
  max-width: 100%;
  font-family: inherit;
  font-size: 16px;
  line-height: 1.5;
  border: none;
  outline: none;
  background: transparent;
  padding: 0;
  margin: 0;
  display: block; /* Changed from inline-block to block */
  resize: none;
  overflow: hidden; /* Changed from auto to hidden */
  white-space: pre-wrap; /* Preserve line breaks */
  word-wrap: break-word;
}
/* Suppression COMPLÈTE de tous les styles visuels */
.date-range {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
}

.date-range select {
  all: unset; /* Réinitialise tous les styles */
  cursor: pointer;
  min-width: 60px;
  text-align: center;
}

.date-range label {
  white-space: nowrap;
}

/* Option : Style de texte différent pour les labels */
.date-range label {
  font-weight: bold;
  color: #555;
  margin-right: 3px;
}
.address-container {
  position: relative;
  display: block; /* Changé de inline-block à block pour une meilleure gestion */
  width: 100%;
  margin-left: 0px; /* Conserve l'indentation */
  min-height: auto; /* Supprime la hauteur fixe */
}

.address-field {
  width: 100%;
  min-height: 1.5em; /* Hauteur minimale d'une ligne */
  border: none;
  border-bottom: 1px dashed #999;
  background: transparent;
  resize: none;
  overflow: hidden;
  font: inherit;
  line-height: 1.4;
  padding: 2px 0;
  white-space:nowrap;
  word-wrap: break-word;
  display: block;
  overflow-x: auto;
}

/* Ajoutez ceci pour une meilleure gestion dynamique */
.address-display {
  white-space: pre-wrap;
  word-wrap: break-word;
  padding: 2px 0;
  line-height: 1.4;
  visibility: hidden;
  position: absolute;
}
.sentence-number {
  font-weight: bold;
}
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>
<body>
   <div id="all-documents">
<span id="text-measurer" class="input-measure"></span>


 <div class="certificate-wrapper" id="certificate-wrapper">
  <div class="container" id="certificate-container" style="background-image: url('certificat.jpg');">
    <div class="certificate-content">
      <div class="sentence">
       <span class="sentence-number">1</span>
       <input class="input-inline auto-width" id="companyName" placeholder="Company Name" />
        ("the Company") is a company incorporated under the laws of England and Wales with registered number
       <input class="input-inline auto-width" id="companyNumber" placeholder="Company Number" />
       having its registered office at :<br>
       <div class="address-container">
       <textarea id="companyAddress" class="address-field" placeholder="e.g.: 2nd Floor, College House, 17 King Edwards Road, Ruislip, London, HA7 4AE, UNITED KINGDOM"></textarea>
       <div id="addressDisplay" class="address-display"></div>
       </div>
   </div>
      <div class="sentence">
         <span class="sentence-number">2</span>
        The above-named signatory is registered as a director of the Company and is authorised to represent the Company.
      </div>
      <div class="sentence">
         <span class="sentence-number">3</span>
        The above-named signatory appeared before me today and produced satisfactory evidence as to identity and after being duly sworn signed the above statement on oath before me.
      </div>
    </div>
  </div>
</div>

   <!-- Profit and Loss -->
<div class="document-container profit-loss financial-form" id="profit-loss-document">
    <div class="date-range">
  <label for="startMonth">From:</label>
  <select id="startMonth">
    <option value="01">January</option>
    <option value="02">February</option>
    <option value="03">March</option>
    <option value="04">April</option>
    <option value="05">May</option>
    <option value="06">June</option>
    <option value="07">July</option>
    <option value="08">August</option>
    <option value="09">September</option>
    <option value="10">October</option>
    <option value="11">November</option>
    <option value="12">December</option>
  </select>

<!-- Years options 2010 to 2100 -->
<select id="startYear">
  <option value="2010">2010</option>
  <option value="2011">2011</option>
  <option value="2012">2012</option>
  <option value="2013">2013</option>
  <option value="2014">2014</option>
  <option value="2015">2015</option>
  <option value="2016">2016</option>
  <option value="2017">2017</option>
  <option value="2018">2018</option>
  <option value="2019">2019</option>
  <option value="2020">2020</option>
  <option value="2021">2021</option>
  <option value="2022">2022</option>
  <option value="2023">2023</option>
  <option value="2024">2024</option>
  <option value="2025">2025</option>
  <option value="2026">2026</option>
  <option value="2027">2027</option>
  <option value="2028">2028</option>
  <option value="2029">2029</option>
  <option value="2030">2030</option>
  <option value="2031">2031</option>
  <option value="2032">2032</option>
  <option value="2033">2033</option>
  <option value="2034">2034</option>
  <option value="2035">2035</option>
  <option value="2036">2036</option>
  <option value="2037">2037</option>
  <option value="2038">2038</option>
  <option value="2039">2039</option>
  <option value="2040">2040</option>
  <option value="2041">2041</option>
  <option value="2042">2042</option>
  <option value="2043">2043</option>
  <option value="2044">2044</option>
  <option value="2045">2045</option>
  <option value="2046">2046</option>
  <option value="2047">2047</option>
  <option value="2048">2048</option>
  <option value="2049">2049</option>
  <option value="2050">2050</option>
  <option value="2051">2051</option>
  <option value="2052">2052</option>
  <option value="2053">2053</option>
  <option value="2054">2054</option>
  <option value="2055">2055</option>
  <option value="2056">2056</option>
  <option value="2057">2057</option>
  <option value="2058">2058</option>
  <option value="2059">2059</option>
  <option value="2060">2060</option>
  <option value="2061">2061</option>
  <option value="2062">2062</option>
  <option value="2063">2063</option>
  <option value="2064">2064</option>
  <option value="2065">2065</option>
  <option value="2066">2066</option>
  <option value="2067">2067</option>
  <option value="2068">2068</option>
  <option value="2069">2069</option>
  <option value="2070">2070</option>
  <option value="2071">2071</option>
  <option value="2072">2072</option>
  <option value="2073">2073</option>
  <option value="2074">2074</option>
  <option value="2075">2075</option>
  <option value="2076">2076</option>
  <option value="2077">2077</option>
  <option value="2078">2078</option>
  <option value="2079">2079</option>
  <option value="2080">2080</option>
  <option value="2081">2081</option>
  <option value="2082">2082</option>
  <option value="2083">2083</option>
  <option value="2084">2084</option>
  <option value="2085">2085</option>
  <option value="2086">2086</option>
  <option value="2087">2087</option>
  <option value="2088">2088</option>
  <option value="2089">2089</option>
  <option value="2090">2090</option>
  <option value="2091">2091</option>
  <option value="2092">2092</option>
  <option value="2093">2093</option>
  <option value="2094">2094</option>
  <option value="2095">2095</option>
  <option value="2096">2096</option>
  <option value="2097">2097</option>
  <option value="2098">2098</option>
  <option value="2099">2099</option>
  <option value="2100">2100</option>
</select>


  <label for="endMonth">to</label>
  <select id="endMonth">
    <option value="01">January</option>
    <option value="02">February</option>
    <option value="03">March</option>
    <option value="04">April</option>
    <option value="05" selected>May</option>
    <option value="06">June</option>
    <option value="07">July</option>
    <option value="08">August</option>
    <option value="09">September</option>
    <option value="10">October</option>
    <option value="11">November</option>
    <option value="12">December</option>
  </select>

 <!-- Years options 2010 to 2100 -->
<select id="startYear">
  <option value="2010">2010</option>
  <option value="2011">2011</option>
  <option value="2012">2012</option>
  <option value="2013">2013</option>
  <option value="2014">2014</option>
  <option value="2015">2015</option>
  <option value="2016">2016</option>
  <option value="2017">2017</option>
  <option value="2018">2018</option>
  <option value="2019">2019</option>
  <option value="2020">2020</option>
  <option value="2021">2021</option>
  <option value="2022">2022</option>
  <option value="2023">2023</option>
  <option value="2024">2024</option>
  <option value="2025">2025</option>
  <option value="2026">2026</option>
  <option value="2027">2027</option>
  <option value="2028">2028</option>
  <option value="2029">2029</option>
  <option value="2030">2030</option>
  <option value="2031">2031</option>
  <option value="2032">2032</option>
  <option value="2033">2033</option>
  <option value="2034">2034</option>
  <option value="2035">2035</option>
  <option value="2036">2036</option>
  <option value="2037">2037</option>
  <option value="2038">2038</option>
  <option value="2039">2039</option>
  <option value="2040">2040</option>
  <option value="2041">2041</option>
  <option value="2042">2042</option>
  <option value="2043">2043</option>
  <option value="2044">2044</option>
  <option value="2045">2045</option>
  <option value="2046">2046</option>
  <option value="2047">2047</option>
  <option value="2048">2048</option>
  <option value="2049">2049</option>
  <option value="2050">2050</option>
  <option value="2051">2051</option>
  <option value="2052">2052</option>
  <option value="2053">2053</option>
  <option value="2054">2054</option>
  <option value="2055">2055</option>
  <option value="2056">2056</option>
  <option value="2057">2057</option>
  <option value="2058">2058</option>
  <option value="2059">2059</option>
  <option value="2060">2060</option>
  <option value="2061">2061</option>
  <option value="2062">2062</option>
  <option value="2063">2063</option>
  <option value="2064">2064</option>
  <option value="2065">2065</option>
  <option value="2066">2066</option>
  <option value="2067">2067</option>
  <option value="2068">2068</option>
  <option value="2069">2069</option>
  <option value="2070">2070</option>
  <option value="2071">2071</option>
  <option value="2072">2072</option>
  <option value="2073">2073</option>
  <option value="2074">2074</option>
  <option value="2075">2075</option>
  <option value="2076">2076</option>
  <option value="2077">2077</option>
  <option value="2078">2078</option>
  <option value="2079">2079</option>
  <option value="2080">2080</option>
  <option value="2081">2081</option>
  <option value="2082">2082</option>
  <option value="2083">2083</option>
  <option value="2084">2084</option>
  <option value="2085">2085</option>
  <option value="2086">2086</option>
  <option value="2087">2087</option>
  <option value="2088">2088</option>
  <option value="2089">2089</option>
  <option value="2090">2090</option>
  <option value="2091">2091</option>
  <option value="2092">2092</option>
  <option value="2093">2093</option>
  <option value="2094">2094</option>
  <option value="2095">2095</option>
  <option value="2096">2096</option>
  <option value="2097">2097</option>
  <option value="2098">2098</option>
  <option value="2099">2099</option>
  <option value="2100">2100</option>
</select>
</div>
  <h1>Profit and Loss</h1>
  <h2>INCOME</h2>
  <div class="item">
    <div>4906 Bank Interest Received</div>
    <div class="input-with-pound">
      <input type="text" id="bankInterest" placeholder="ex: 0,97 ou 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>Sales</div>
    <div class="input-with-pound">
      <input type="text" id="sales" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item total">
    <div>Total Income</div>
    <div class="input-with-pound">
      <input type="text" id="totalIncome" readonly />
    </div>
  </div>

  <h2>COST OF SALES</h2>
  <div class="item">
    <div>Purchases</div>
    <div class="input-with-pound">
      <input type="text" id="purchases" placeholder="ex: 0,97 ou 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item total">
    <div>Total Cost of Sales</div>
    <div class="input-with-pound">
      <input type="text" id="totalCostOfSales" readonly />
    </div>
  </div>

  <h2>GROSS PROFIT</h2>
  <div class="item total">
    <div>Gross Profit</div>
    <div class="input-with-pound">
      <input type="text" id="grossProfit" readonly />
    </div>
  </div>

  <h2>EXPENSES</h2>
  <div class="item">
    
    <div> 7400 Travelling</div>
    <div class="input-with-pound">
      <input type="text" id="travelling" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>7501 Postage and Carriage</div>
    <div class="input-with-pound">
      <input type="text" id="postage" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>7552 Computers & Software</div>
    <div class="input-with-pound">
      <input type="text" id="computers" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>7602 Accountancy Fees</div>
    <div class="input-with-pound">
      <input type="text" id="accountancy" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>7902 Currency Charges</div>
    <div class="input-with-pound">
      <input type="text" id="currency" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>Bank Charges</div>
    <div class="input-with-pound">
      <input type="text" id="bankCharges" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item">
    <div>Rent</div>
    <div class="input-with-pound">
      <input type="text" id="rent" placeholder="ex: 180.143,02; 200,50" />
    </div>
  </div>

  <div class="item total">
    <div>Total Expenses</div>
    <div class="input-with-pound">
      <input type="text" id="totalExpenses" readonly />
    </div>
  </div>

  <div class="item total">
    <div>Net Operating Income</div>
    <div class="input-with-pound">
      <input type="text" id="netOperatingIncome" readonly />
    </div>
  </div>
  <div class="item total">
    <div>Net Income</div>
    <div class="input-with-pound">
      <input type="text" id="netIncome" readonly />
    </div>
  </div>
</div>
   <!-- Balance Sheet -->
<div class="document-container balance-sheet financial-form" id="balance-sheet-document">
   <div> 
         <div class="date-range">
  <label for="startMonth">From:</label>
  <select id="startMonth">
    <option value="01">January</option>
    <option value="02">February</option>
    <option value="03">March</option>
    <option value="04">April</option>
    <option value="05">May</option>
    <option value="06">June</option>
    <option value="07">July</option>
    <option value="08">August</option>
    <option value="09">September</option>
    <option value="10">October</option>
    <option value="11">November</option>
    <option value="12">December</option>
  </select>

<!-- Years options 2010 to 2100 -->
<select id="startYear">
  <option value="2010">2010</option>
  <option value="2011">2011</option>
  <option value="2012">2012</option>
  <option value="2013">2013</option>
  <option value="2014">2014</option>
  <option value="2015">2015</option>
  <option value="2016">2016</option>
  <option value="2017">2017</option>
  <option value="2018">2018</option>
  <option value="2019">2019</option>
  <option value="2020">2020</option>
  <option value="2021">2021</option>
  <option value="2022">2022</option>
  <option value="2023">2023</option>
  <option value="2024">2024</option>
  <option value="2025">2025</option>
  <option value="2026">2026</option>
  <option value="2027">2027</option>
  <option value="2028">2028</option>
  <option value="2029">2029</option>
  <option value="2030">2030</option>
  <option value="2031">2031</option>
  <option value="2032">2032</option>
  <option value="2033">2033</option>
  <option value="2034">2034</option>
  <option value="2035">2035</option>
  <option value="2036">2036</option>
  <option value="2037">2037</option>
  <option value="2038">2038</option>
  <option value="2039">2039</option>
  <option value="2040">2040</option>
  <option value="2041">2041</option>
  <option value="2042">2042</option>
  <option value="2043">2043</option>
  <option value="2044">2044</option>
  <option value="2045">2045</option>
  <option value="2046">2046</option>
  <option value="2047">2047</option>
  <option value="2048">2048</option>
  <option value="2049">2049</option>
  <option value="2050">2050</option>
  <option value="2051">2051</option>
  <option value="2052">2052</option>
  <option value="2053">2053</option>
  <option value="2054">2054</option>
  <option value="2055">2055</option>
  <option value="2056">2056</option>
  <option value="2057">2057</option>
  <option value="2058">2058</option>
  <option value="2059">2059</option>
  <option value="2060">2060</option>
  <option value="2061">2061</option>
  <option value="2062">2062</option>
  <option value="2063">2063</option>
  <option value="2064">2064</option>
  <option value="2065">2065</option>
  <option value="2066">2066</option>
  <option value="2067">2067</option>
  <option value="2068">2068</option>
  <option value="2069">2069</option>
  <option value="2070">2070</option>
  <option value="2071">2071</option>
  <option value="2072">2072</option>
  <option value="2073">2073</option>
  <option value="2074">2074</option>
  <option value="2075">2075</option>
  <option value="2076">2076</option>
  <option value="2077">2077</option>
  <option value="2078">2078</option>
  <option value="2079">2079</option>
  <option value="2080">2080</option>
  <option value="2081">2081</option>
  <option value="2082">2082</option>
  <option value="2083">2083</option>
  <option value="2084">2084</option>
  <option value="2085">2085</option>
  <option value="2086">2086</option>
  <option value="2087">2087</option>
  <option value="2088">2088</option>
  <option value="2089">2089</option>
  <option value="2090">2090</option>
  <option value="2091">2091</option>
  <option value="2092">2092</option>
  <option value="2093">2093</option>
  <option value="2094">2094</option>
  <option value="2095">2095</option>
  <option value="2096">2096</option>
  <option value="2097">2097</option>
  <option value="2098">2098</option>
  <option value="2099">2099</option>
  <option value="2100">2100</option>
</select>


  <label for="endMonth">to</label>
  <select id="endMonth">
    <option value="01">January</option>
    <option value="02">February</option>
    <option value="03">March</option>
    <option value="04">April</option>
    <option value="05" selected>May</option>
    <option value="06">June</option>
    <option value="07">July</option>
    <option value="08">August</option>
    <option value="09">September</option>
    <option value="10">October</option>
    <option value="11">November</option>
    <option value="12">December</option>
  </select>

 <!-- Years options 2010 to 2100 -->
<select id="startYear">
  <option value="2010">2010</option>
  <option value="2011">2011</option>
  <option value="2012">2012</option>
  <option value="2013">2013</option>
  <option value="2014">2014</option>
  <option value="2015">2015</option>
  <option value="2016">2016</option>
  <option value="2017">2017</option>
  <option value="2018">2018</option>
  <option value="2019">2019</option>
  <option value="2020">2020</option>
  <option value="2021">2021</option>
  <option value="2022">2022</option>
  <option value="2023">2023</option>
  <option value="2024">2024</option>
  <option value="2025">2025</option>
  <option value="2026">2026</option>
  <option value="2027">2027</option>
  <option value="2028">2028</option>
  <option value="2029">2029</option>
  <option value="2030">2030</option>
  <option value="2031">2031</option>
  <option value="2032">2032</option>
  <option value="2033">2033</option>
  <option value="2034">2034</option>
  <option value="2035">2035</option>
  <option value="2036">2036</option>
  <option value="2037">2037</option>
  <option value="2038">2038</option>
  <option value="2039">2039</option>
  <option value="2040">2040</option>
  <option value="2041">2041</option>
  <option value="2042">2042</option>
  <option value="2043">2043</option>
  <option value="2044">2044</option>
  <option value="2045">2045</option>
  <option value="2046">2046</option>
  <option value="2047">2047</option>
  <option value="2048">2048</option>
  <option value="2049">2049</option>
  <option value="2050">2050</option>
  <option value="2051">2051</option>
  <option value="2052">2052</option>
  <option value="2053">2053</option>
  <option value="2054">2054</option>
  <option value="2055">2055</option>
  <option value="2056">2056</option>
  <option value="2057">2057</option>
  <option value="2058">2058</option>
  <option value="2059">2059</option>
  <option value="2060">2060</option>
  <option value="2061">2061</option>
  <option value="2062">2062</option>
  <option value="2063">2063</option>
  <option value="2064">2064</option>
  <option value="2065">2065</option>
  <option value="2066">2066</option>
  <option value="2067">2067</option>
  <option value="2068">2068</option>
  <option value="2069">2069</option>
  <option value="2070">2070</option>
  <option value="2071">2071</option>
  <option value="2072">2072</option>
  <option value="2073">2073</option>
  <option value="2074">2074</option>
  <option value="2075">2075</option>
  <option value="2076">2076</option>
  <option value="2077">2077</option>
  <option value="2078">2078</option>
  <option value="2079">2079</option>
  <option value="2080">2080</option>
  <option value="2081">2081</option>
  <option value="2082">2082</option>
  <option value="2083">2083</option>
  <option value="2084">2084</option>
  <option value="2085">2085</option>
  <option value="2086">2086</option>
  <option value="2087">2087</option>
  <option value="2088">2088</option>
  <option value="2089">2089</option>
  <option value="2090">2090</option>
  <option value="2091">2091</option>
  <option value="2092">2092</option>
  <option value="2093">2093</option>
  <option value="2094">2094</option>
  <option value="2095">2095</option>
  <option value="2096">2096</option>
  <option value="2097">2097</option>
  <option value="2098">2098</option>
  <option value="2099">2099</option>
  <option value="2100">2100</option>
 </select>
 </div>
  <h1>Balance Sheet</h1>
  <!-- ACTIFS COURANTS -->
  <div class="section">
   <h2>FIXED ASSET</h2> 
  <h3>Total Fixed Asset</h3>
<div class="item total">
  <h4>CASH AT BANK AND IN HAND</h4>
</div>
    
    <div class="account-item">
      <div class="account-number">1104</div>
      <div class="account-name">Inter Company Account</div>
      <div class="input-with-pound"> <input type="text" id="interCompany" placeholder="ex: 180.143,02; 200,50" /> </div>
    </div>

    <div class="account-item">
      <div class="account-number">1200</div>
      <div class="account-name">Santander Account</div>
      <div class="input-with-pound"><input type="text"  placeholder="ex: 180.143,02; 200,50" id="santander"/> </div>
    </div>

    <div class="account-item">
      <div class="account-number">1201</div>
      <div class="account-name">Stripe Account</div>
      <div class="input-with-pound"><input type="text" placeholder="ex: 180.143,02; 200,50" id="stripe" /></div>
    </div>

    <div class="account-item">
      <div class="account-number">1202</div>
      <div class="account-name">Paypal Account</div>
      <div class="input-with-pound"><input type="text" placeholder="ex: 180.143,02; 200,50" id="paypal" /></div>
    </div>

    <div class="account-item">
      <div class="account-number">1204</div>
      <div class="account-name">Elavon UK</div>
      <div class="input-with-pound"><input type="text" placeholder="ex: 180.143,02; 200,50"  id="elavon" /></div>
    </div>

    <!-- Version corrigée -->
<div class="item total">
  <div>Total Cash at Bank and in Hand</div>
  <div class="input-with-pound">
  <input type="text" id="totalCash" value="0" readonly />
  </div>
</div>


    <div class="account-item">
      <div class="account-number">1100</div>
      <div class="account-name">Debtors Control Account</div>
      <div class="input-with-pound"><input type="text" placeholder="ex: 180.143,02; 200,50" id="debtorsControlAccount" /></div>
    </div>

    <div class="total">
      <div>Total Debtors</div>
      <div class="input-with-pound"><input type="text" id="totalDebtors"  readonly /></div>
    </div>

    <div class="main-total">
      <div>Net Current Assets</div>
      <div class="input-with-pound"><input type="text" id="netCurrentAssets" readonly /></div>
    </div>
  </div>

  <!-- PASSIFS COURANTS -->
  <div class="section">
    <h2>CREDITORS:AMOUNTS FALLING DUE WITHIN ONE YEAR</h2>
    <h3>Trade Creditors</h3>
    <div class="account-item">
      <div class="account-number">2100</div>
      <div class="account-name"> Creditors Control Account</div>
      <div class="input-with-pound"><input type="text" placeholder="ex: 180.143,02; 200,50"  id="tradeCreditors"  /></div>
    </div>
     <div class="total">
    <div>Total Trade Creditors</div>
    <div class="input-with-pound"><input type="text" id="totalTradecreditors" readonly /></div>
    </div>
     <h2>Current Liabilities</h2>

    <div class="sub-item">
      <div class="account-name">Corporation Tax Payable</div>
      <div class="input-with-pound"><input type="text"placeholder="ex: 180.143,02; 200,50" id="corporateTax" /></div>
    </div>

    <div class="sub-item">
      <div class="account-name">VAT Control</div>
      <div class="input-with-pound"><input type="text"placeholder="ex: 180.143,02; 200,50" id="vatGroup" /></div>
    </div>

    <div class="sub-item">
      <div class="account-name">VAT Suspense</div>
      <div class="input-with-pound"><input type="text"placeholder="ex: 180.143,02; 200,50"  id="vatServices" /></div>
    </div>

    <div class="total">
   <div>Total Current Liabilities</div>
  <div class="input-with-pound"><input type="text" id="totalCurrentLiabilities" readonly /></div>
   </div>
       <div class="total">
      <div>Total Creditors :amounts falling due within one year</div>
      <div class="input-with-pound"><input type="text" id="totalCreditors" readonly /></div>
    </div>

   

    <div class="main-total">
      <div>Net Current Assets (Liabilities)</div>
      <div class="input-with-pound"><input type="text" id="netCurrentAssetsLiabilities" style="font-weight: bold;" readonly /></div>
    </div>
  </div>
      <div class="main-total">
       <div>Total Assets Less Current Liabilities</div>
       <div class="input-with-pound"><input type="text" id="totalAssetsLessLiabilities" readonly /></div>
      </div>
  </div>

  <!-- PASSIFS À LONG TERME -->
  <div class="section">
    <h2>CRIDITORS:AMOUNTS FALLING DUE AFTER MORE THAN ONE YEAR </h2>

    <div class="account-item">
      <div class="account-number">2300</div>
      <div class="account-name">Loans</div>
      <div class="input-with-pound"><input type="text" placeholder="ex: 180.143,02; 200,50" id="loans"/></div>
    </div>

    <div class="account-item">
      <div class="account-number">2301</div>
      <div class="account-name">Directors Loan Accounts (Director 1)</div>
      <div class="input-with-pound"><input type="text" placeholder="ex: 180.143,02; 200,50" id="directLoan" /></div>
    </div>

    <div class="total">
      <div>Total Creditors : amounts falling due after more than one year</div>
      <div class="input-with-pound"><input type="text" id="totalCreditorsLoans" style="font-weight: bold;" readonly /></div>
    </div>

    <div class="main-total">
      <div>Total Net Assets (Liabilities)</div>
      <div class="input-with-pound"><input type="text" id="totalNetAssets" style="font-weight: bold;"  readonly /></div>
    </div>
  </div>

  <!-- CAPITAUX PROPRES -->
  <div class="section">
    <h2>CAPITAL AND RESERVES </h2>

    <div class="account-item">
      <div class="account-number">3000</div>
      <div class="account-name"> Ordinary Shares</div>
      <div class="input-with-pound"><input type="text" placeholder="ex: 180.143,02; 200,50" id="ordinaryShares" /></div>
    </div>

    <div class="account-item">
      <div class="account-name">Retained Earnings</div>
      <div class="input-with-pound"><input type="text"placeholder="ex: 180.143,02; 200,50" id="retainedEarnings"/></div>
    </div>

    <div class="account-item">
      <div class="account-name">Profit for the Year</div>
      <div class="input-with-pound"><input type="text"placeholder="ex: 180.143,02; 200,50"  id="profitForYear" /></div>
    </div>

    <div class="total">
      <div>Total Capital and Reserves</div>
      <div class="input-with-pound"><input type="text" id="totalCapitalReserves" style="font-weight: bold;"  readonly /></div>
    </div>
  </div>
</div>
</div>
<div class="button-container">
  <button id="downloadAllBtn">Download all documents in PDF</button>
</div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <script> 
    // Configuration du champ d'adresse
const addressField = document.getElementById('companyAddress');
const addressDisplay = document.getElementById('addressDisplay');

function updateAddressField() {
  addressDisplay.textContent = addressField.value;
  addressField.style.height = 'auto';
  addressField.style.height = addressDisplay.scrollHeight + 'px';
}

addressField.addEventListener('paste', function(e) {
  e.preventDefault();
  let text = e.clipboardData.getData('text/plain');
  
  // Supprime les sauts de ligne et espaces superflus
  text = text.replace(/[\n\r]+/g, ' ').replace(/\s+/g, ' ').trim();
  
  // Met à jour le textarea et le div de prévisualisation
  addressField.value = text;
  addressDisplay.textContent = text;
  
  // Ajuste la hauteur automatiquement
  updateAddressField();
});

// Initialisation
updateAddressField();
  </script>
<script>
  document.querySelectorAll('input[type="text"], input[type="text"]').forEach(input => {
    if (!input.parentElement.classList.contains('input-with-pound')) {
      const wrapper = document.createElement('div');
      wrapper.classList.add('input-with-pound');
      input.parentElement.replaceChild(wrapper, input);
      wrapper.appendChild(input);
    }
  });

  const inputs = document.querySelectorAll('.auto-width');
  inputs.forEach(input => {
    input.style.width = '10px';
    input.addEventListener('input', () => {
      input.style.width = '10px';
      input.style.width = (input.value.length + 1) + 'ch';
    });
  });

  const { jsPDF } = window.jspdf;

  const certInputs = document.querySelectorAll('.input-inline');
  const measurer = document.getElementById('text-measurer');

  certInputs.forEach(input => {
    const adjustWidth = () => {
      measurer.style.font = getComputedStyle(input).font;
      measurer.textContent = input.value || input.placeholder || "";
      input.style.width = (measurer.scrollWidth + 10) + "px";
    };

    input.addEventListener('input', adjustWidth);
    adjustWidth();

    input.addEventListener('input', () => {
      if (input.value.trim() !== '') {
        input.classList.add('input-no-border');
      } else {
        input.classList.remove('input-no-border');
      }
    });
  });

function parseEnglishNumber(str) {
  if (!str) return NaN;
  // Supprime les virgules des milliers (ex: "1,000.50" → "1000.50")
  str = str.trim().replace(/,/g, '');
  return parseFloat(str);
}

 function sumEnglishNumbersFromInput(id) {
  const input = document.getElementById(id);
  const value = input.value;
  if (!value) return 0;

  const parts = value.split(';').map(s => s.trim()).filter(s => s !== '');
  const numbers = parts.map(parseEnglishNumber).filter(n => !isNaN(n));

  // Validation du format anglais
  if (parts.length !== numbers.length) {
    input.style.border = "1px solid red";
    console.error("Invalid English number format in field", id);
  } else {
    input.style.border = "";
  }

  return numbers.reduce((a, b) => a + b, 0);
}

 function formatEnglishNumber(num) {
  return num.toLocaleString('en-US', {
    minimumFractionDigits: 2,
    maximumFractionDigits: 2
  });
}

  function calculateProfitLoss() {
   const bankInterestSum = sumEnglishNumbersFromInput('bankInterest');
    const salesSum = sumEnglishNumbersFromInput('sales');
    const totalIncome = bankInterestSum + salesSum;
    document.getElementById('totalIncome').value = formatEnglishNumber(totalIncome);

    const purchasesSum = sumEnglishNumbersFromInput('purchases');
    document.getElementById('totalCostOfSales').value = formatEnglishNumber(purchasesSum);

    const grossProfit = totalIncome - purchasesSum;
    document.getElementById('grossProfit').value = formatEnglishNumber(grossProfit);

    const expenseFields = ['travelling', 'postage', 'computers', 'accountancy', 'currency', 'bankCharges', 'rent'];
    const totalExpenses = expenseFields.map(sumEnglishNumbersFromInput).reduce((a, b) => a + b, 0);
    document.getElementById('totalExpenses').value = formatEnglishNumber(totalExpenses);

    const netOperatingIncome = grossProfit - totalExpenses;
    document.getElementById('netOperatingIncome').value = formatEnglishNumber(netOperatingIncome);
    document.getElementById('netIncome').value = formatEnglishNumber(netOperatingIncome);
  }

  const profitLossInputIds = [
    'bankInterest', 'sales', 'purchases',
    'travelling', 'postage', 'computers',
    'accountancy', 'currency', 'bankCharges', 'rent'
  ];

  profitLossInputIds.forEach(id => {
    document.getElementById(id).addEventListener('input', calculateProfitLoss);
  });

 function getVal(id) {
  const input = document.getElementById(id);
  const val = parseEnglishNumber(input.value);
  
  // Exemple : Bloquer les valeurs négatives pour les comptes bancaires
  if (['santander', 'stripe', 'paypal'].includes(id) && val < 0) {
    input.style.border = "1px solid red";
    return 0;
  } else {
    input.style.border = "";
    return isNaN(val) ? 0 : val;
  }
}
function formatEnglishNumber(num) {
  return num.toLocaleString('en-US', {
    minimumFractionDigits: 2,
    maximumFractionDigits: 2
  });
}

  function calculateBalanceSheet() {
    const totalCash = getVal('interCompany') + getVal('santander') + getVal('stripe') + getVal('paypal') + getVal('elavon');
    document.getElementById('totalCash').value =formatEnglishNumber(totalCash);

    const totalDebtors = getVal('debtorsControlAccount');
    document.getElementById('totalDebtors').value =formatEnglishNumber( totalDebtors);

    const netCurrentAssets = totalCash + totalDebtors;
    document.getElementById('netCurrentAssets').value =formatEnglishNumber(netCurrentAssets);

    const totalCurrentLiabilities = getVal('corporateTax') + getVal('vatGroup') + getVal('vatServices');
    document.getElementById('totalCurrentLiabilities').value = formatEnglishNumber(totalCurrentLiabilities);

    const totalTradecreditors = getVal('tradeCreditors');
    document.getElementById('totalTradecreditors').value =formatEnglishNumber( totalTradecreditors);

    const totalCreditors = totalTradecreditors + totalCurrentLiabilities;
    document.getElementById('totalCreditors').value = formatEnglishNumber(totalCreditors);

    const netCurrentAssetsLiabilities = netCurrentAssets - totalCreditors;
    document.getElementById('netCurrentAssetsLiabilities').value = formatEnglishNumber(netCurrentAssetsLiabilities);

    const totalAssetsLessLiabilities = getVal('netCurrentAssetsLiabilities');
     document.getElementById('totalAssetsLessLiabilities').value = formatEnglishNumber(totalAssetsLessLiabilities);

    const totalCreditorsLoans = getVal('loans') + getVal('directLoan');
    document.getElementById('totalCreditorsLoans').value = formatEnglishNumber(totalCreditorsLoans);

    const totalNetAssets = netCurrentAssetsLiabilities - totalCreditorsLoans;
    document.getElementById('totalNetAssets').value = formatEnglishNumber(totalNetAssets);

  


    const totalCapitalReserves = getVal('ordinaryShares') + getVal('retainedEarnings') + getVal('profitForYear');
    document.getElementById('totalCapitalReserves').value = formatEnglishNumber(totalCapitalReserves);
  }

  const balanceSheetFields = [
    'interCompany', 'santander', 'stripe', 'paypal', 'elavon',
    'debtorsControlAccount', 'tradeCreditors', 'corporateTax',
    'vatGroup', 'vatServices', 'loans', 'directLoan',
    'ordinaryShares', 'retainedEarnings', 'profitForYear'
  ];

  balanceSheetFields.forEach(id => {
    document.getElementById(id).addEventListener('input', calculateBalanceSheet);
  });

  calculateProfitLoss();
  calculateBalanceSheet();
  // Fonction pour préparer un élément pour le PDF
function prepareElementForPDF(elementId) {
  const element = document.getElementById(elementId);
  if (!element) return null;
  
  const clone = element.cloneNode(true);
  clone.id = 'pdf-clone-' + elementId;
  clone.style.visibility = 'visible';
  clone.style.position = 'static';
  clone.style.backgroundColor = 'white';
  
  element.parentNode.insertBefore(clone, element);
  element.style.visibility = 'hidden';
  element.style.position = 'absolute';
  
  return { original: element, clone: clone };
}
addressField.addEventListener('paste', function(e) {
  e.preventDefault(); // Empêche le collage par défaut
  let text = e.clipboardData.getData('text/plain');
  
  // Remplace les sauts de ligne par des espaces et supprime les espaces multiples
  text = text.replace(/\n/g, ' ').replace(/\s+/g, ' ').trim();
  
  // Insère le texte nettoyé
  document.execCommand('insertText', false, text);
});

// Fonction pour restaurer l'élément original
function restoreElementAfterPDF(backup) {
  if (!backup) return;
  
  backup.original.style.visibility = '';
  backup.original.style.position = '';
  backup.clone.parentNode.removeChild(backup.clone);
}
  document.getElementById('downloadAllBtn').addEventListener('click', async function () {
    this.textContent = "Génération en cours...";
    this.disabled = true;

    try {
      const doc = new jsPDF('p', 'mm', 'a4');
      const pageWidth = doc.internal.pageSize.getWidth();
      const pageHeight = doc.internal.pageSize.getHeight();
      doc.deletePage(1);

      const addHtmlContent = async (elementId, title = '') => {
        const element = document.getElementById(elementId);
        if (!element) return;

        const originalBg = element.style.backgroundColor;
        element.style.backgroundColor = 'white';

        const canvas = await html2canvas(element, {
          scale: 1.2,
          logging: false,
          useCORS: true,
          allowTaint: false,
          backgroundColor: '#FFFFFF'
        });

        element.style.backgroundColor = originalBg;

        doc.addPage('a4');
        doc.setFillColor(255, 255, 255);
        doc.rect(0, 0, pageWidth, pageHeight, 'F');

        if (title) {
          doc.setFontSize(16);
          doc.setTextColor(0, 0, 0);
          doc.text(title, 20, 20);
        }

        const imgData = canvas.toDataURL('image/jpeg', 0.8);
        const imgWidth = pageWidth - 40;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;

        doc.addImage(imgData, 'JPEG', 20, title ? 30 : 20, imgWidth, imgHeight);
      };
    // Fonction pour ajouter une page avec une image (via URL)
    const addImagePage = async (imgUrl) => {
      return new Promise((resolve) => {
        const img = new Image();
        img.crossOrigin = "anonymous";

        img.onload = function() {
          doc.addPage('a4');

          const ratio = Math.min(
            (pageWidth - 20) / img.width,
            (pageHeight - 20) / img.height
          );
          const imgWidth = img.width * ratio;
          const imgHeight = img.height * ratio;

          const x = (pageWidth - imgWidth) / 2;
          const y = (pageHeight - imgHeight) / 2;

          doc.setFillColor(255, 255, 255);
          doc.rect(0, 0, pageWidth, pageHeight, 'F');

          doc.addImage(img, 'JPEG', x, y, imgWidth, imgHeight);
          resolve();
        };

        img.onerror = () => {
          console.error("Erreur de chargement de l'image:", imgUrl);
          resolve();
        };

        if (!imgUrl.startsWith('/')) {
          imgUrl = '/' + imgUrl;
        }
        img.src = imgUrl;
      });
    };
    function prepareForPDF() {
  const display = document.createElement('div');
  display.className = 'address-display';
  display.style.visibility = 'visible';
  display.textContent = addressField.value;
  addressField.parentNode.replaceChild(display, addressField);
}
      await addHtmlContent('certificate-wrapper');
      await addImagePage('cert.jpeg');
      await addImagePage('tab.jpeg');
      await addHtmlContent('profit-loss-document');
      await addHtmlContent('balance-sheet-document');

      doc.save('Documents_Complets.pdf');

    } catch (error) {
      console.error(error);
      alert("Erreur lors de la génération du PDF: " + error.message);
    } finally {
      this.textContent = "Télécharger tous les documents en PDF";
      this.disabled = false;
    }
  });
</script>

</body>
</html>